---
import AdminLayout from "../../../layouts/AdminLayout.astro";

// 1. Fetch Data Customer
let customers: any[] = [];
try {
    const res = await fetch("http://localhost:3000/api/customers");
    customers = await res.json();
} catch (error) {
    // Data Dummy jika backend belum siap
    customers = [
        {
            id: 1,
            name: "Budi Santoso",
            email: "budi@gmail.com",
            phone: "081234567890",
            address: "Jl. Merpati No 5",
        },
        {
            id: 2,
            name: "Siti Aminah",
            email: "siti@yahoo.com",
            phone: "089876543210",
            address: "Jl. Anggrek No 12",
        },
    ];
}
---

<AdminLayout title="Data Pelanggan">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-gray-800">Data Pelanggan</h2>
        <a
            href="/admin/customers/add"
            class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">
            + Tambah Manual
        </a>
    </div>

    <div class="bg-white shadow-md rounded-lg overflow-hidden">
        <table class="min-w-full text-left border-collapse">
            <thead class="bg-gray-100 text-gray-700 uppercase text-sm">
                <tr>
                    <th class="py-3 px-6 border-b">Nama</th>
                    <th class="py-3 px-6 border-b">Email</th>
                    <th class="py-3 px-6 border-b">No. HP</th>
                    <th class="py-3 px-6 border-b text-center">Aksi</th>
                </tr>
            </thead>
            <tbody class="text-gray-600 text-sm font-light">
                {
                    customers.map((c: any) => (
                        <tr class="border-b hover:bg-gray-50 transition">
                            <td class="py-3 px-6 font-medium">{c.name}</td>
                            <td class="py-3 px-6">{c.email}</td>
                            <td class="py-3 px-6">{c.phone}</td>

                            <td class="py-3 px-6 text-center">
                                <div class="flex item-center justify-center space-x-2">
                                    <a
                                        href={`/admin/customers/edit/${c.id}`}
                                        class="bg-yellow-500 text-white px-3 py-1 rounded text-xs hover:bg-yellow-600 transition">
                                        Edit
                                    </a>
                                    <button
                                        class="bg-red-500 text-white px-3 py-1 rounded text-xs hover:bg-red-600 transition"
                                        onclick={`alert('Hapus Customer: ${c.name}')`}>
                                        Hapus
                                    </button>
                                </div>
                            </td>
                        </tr>
                    ))
                }
            </tbody>
        </table>
    </div>
</AdminLayout>
