---
// src/layouts/PublicLayout.astro
import "../style/global.css";
import { Image } from "astro:assets";
import logo from "../assets/logo1.png";
import Footer from "../components/Footer.astro";

const { title } = Astro.props;

// --- 1. FETCH DATA KATEGORI (Untuk Dropdown) ---
let categories = [];
try {
  const res = await fetch('http://localhost:3000/api/categories');
  const data = await res.json();
  categories = data.data || data || [];
} catch (e) {
  // Dummy data jika backend mati
  categories = [
    { id: 1, name: "Makanan Berat" },
    { id: 2, name: "Minuman" },
    { id: 3, name: "Snack" }
  ];
}
---

<html lang="id">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width" />
        <title>{title} | Ngenyangin</title>

        <link
            href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap"
            rel="stylesheet"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
        />
        <script
            src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"
            is:inline></script>
    </head>
    <body class="bg-[#FDFBF7] font-['Poppins']">
        
        <nav class="bg-[#C81E1E] py-4 shadow-lg sticky top-0 z-50 relative">
            <div class="max-w-7xl mx-auto px-6 flex justify-between items-center h-full">
                
                <div class="flex items-center">
                    <a href="/">
                        <Image src={logo} alt="Logo" class="h-10 w-auto" />
                    </a>
                </div>

                <div class="absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 hidden md:flex items-center space-x-10 text-white font-bold gap-5">
                    
                    <a href="/#home" class="nav-link transition pb-1 hover:text-yellow-400">
                        Home
                    </a>

                    <a href="/#menu" class="nav-link transition pb-1 hover:text-yellow-400">
                        Our Menu
                    </a>

                    <div class="relative group py-2"> <a href="/#kategori" class="nav-link transition pb-1 hover:text-yellow-400 flex items-center gap-1 cursor-pointer">
                    Kategori
                    </div>
                </div>

                <div class="flex justify-end gap-4 ">
                    <div class="relative hidden sm:block">
                        <input
                            id="search-input"
                            type="text"
                            placeholder="Cari Menu"
                            class="bg-[#A10004] border-2 border-[#FEB516] text-white rounded-full py-2 px-6 pl-10 w-48 focus:outline-none text-sm placeholder-white"
                        />
                        <span class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-[#B91C1C] px-4 py-1.5 rounded-full transition cursor-pointer">
                            <svg width="18" height="18" viewBox="0 0 33 33" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M26.95 28.875L18.2875 20.2125C17.6 20.7625 16.8094 21.1979 15.9156 21.5187C15.0219 21.8396 14.0708 22 13.0625 22C10.5646 22 8.45075 21.1347 6.721 19.404C4.99125 17.6733 4.12592 15.5595 4.125 13.0625C4.12408 10.5655 4.98942 8.45167 6.721 6.721C8.45258 4.99033 10.5664 4.125 13.0625 4.125C15.5586 4.125 17.6729 4.99033 19.4054 6.721C21.1379 8.45167 22.0028 10.5655 22 13.0625C22 14.0708 21.8396 15.0219 21.5188 15.9156C21.1979 16.8094 20.7625 17.6 20.2125 18.2875L28.875 26.95L26.95 28.875ZM13.0625 19.25C14.7813 19.25 16.2424 18.6487 17.446 17.446C18.6496 16.2433 19.2509 14.7822 19.25 13.0625C19.2491 11.3428 18.6478 9.88213 17.446 8.68038C16.2443 7.47863 14.7831 6.87683 13.0625 6.875C11.3419 6.87317 9.88121 7.47496 8.68038 8.68038C7.47954 9.88579 6.87775 11.3465 6.875 13.0625C6.87225 14.7785 7.47404 16.2397 8.68038 17.446C9.88671 18.6523 11.3474 19.2537 13.0625 19.25Z" fill="#FEB516"/>
                            </svg>
                        </span>
                    </div>
                    <a href="/login" class="bg-white hover:bg-gray-100 text-red-600 w-10 h-10 border-4 border-[#FEB516] rounded-full flex items-center justify-center font-bold shadow-md cursor-pointer transition">
                        A
                    </a>
                </div>
            </div>
        </nav>

        <main>
            <slot />
        </main>
        
        <Footer />

        <script src="../scripts/navbar.js"></script>

        <style>
            /* Highlight Menu Aktif (Scroll Spy) */
            .active-nav {
                color: #ffc107 !important;
                position: relative;
            }

            .active-nav::after {
                content: "";
                position: absolute;
                bottom: -4px;
                left: 0;
                width: 100%;
                height: 4px;
                background-color: #ffc107;
                border-radius: 9999px;
                transition: all 0.3s ease;
            }
        </style>
    </body>
</html>